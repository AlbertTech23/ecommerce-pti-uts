<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ALT Equipment</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="main.css" />
    <link rel="icon" type="image/x-icon" href="./assets/logo-white.ico" />
    <script src="navbar.js"></script>
  </head>
  <body>
    <!-- navbar -->
    <div id="navbarContainer"></div>
    <!-- products -->
    <div
      class="products d-flex flex-wrap p-5 m-5 justify-content-center"
      id="productList"
    ></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.10.2/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"></script>
    <script
      src="https://code.jquery.com/jquery-3.7.1.js"
      integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
      crossorigin="anonymous"
    ></script>
    <script>
      const navbarContainer = document.getElementById("navbarContainer");

      // Fetch "navbar.html"
      fetch("navbar.html")
        .then((response) => response.text())
        .then((data) => {
          // Insert the content into the "navbarContainer"
          navbarContainer.innerHTML = data;

          // Run your code after inserting the content
          $(document).ready(function () {
            // Retrieve the username from session storage
            var username = sessionStorage.getItem("username");

            // Check if the username exists
            if (username !== null) {
              // Hide the "Login" link
              $(".nav-link[href='login.html']").hide();
              // Show the username in the designated element
              $("#usernameDisplay").text(username);
              $("#usernameDisplay").show(); // Display the username element
            }
            setBalance(100);
          });
        });
    </script>
    <script type="module">
      import { PRODUCTS } from "./products.js"; // import { PRODUCTS } from "./products.js";
      function displayProducts() {
        const productList = document.getElementById("productList");

        PRODUCTS.forEach((product) => {
          const productDiv = document.createElement("div");
          productDiv.classList.add("product");
          productDiv.innerHTML = `
          <div class="product-container">
            <h2 class="fw-bold">${product.productName}</h2>
            <img class="mt-3 mb-3" src="${product.productImage}" alt="${product.productName}">
            <div class="price-container d-flex row">
              <div class="pricing col-sm">
                <p class="real-price">$${product.price}</p>
                <p class="disc-price">$${product.discountedPrice}</p>
              </div>
              <button class="col-sm" onclick="addToCart(${product.id})">Add to Cart</button>
            </div>
          </div>
          `;
          productList.appendChild(productDiv);
        });
      }
      displayProducts();
    </script>
    <script>
      function getBalance() {
        return document.getElementById("balanceDisplay").innerText;
      }

      function setBalance(balance) {
        document.getElementById("balanceDisplay").innerText = "$" + balance;
      }
    </script>
    <script>
      function addToCart(productId) {
        // Get the current cart from session storage
        let cart = JSON.parse(sessionStorage.getItem("cart"));

        // If the cart is null, set it to an empty array
        if (cart === null) {
          cart = [];
        }

        // Add the product ID to the cart
        cart.push(productId);

        // Save the cart in session storage
        sessionStorage.setItem("cart", JSON.stringify(cart));

        // Update the cart count on the screen
        updateCartCount();
      }

      function updateCartCount() {
        let cart = JSON.parse(sessionStorage.getItem("cart"));
        $(".cart-size").text(cart.length);
      }

      updateCartCount();
    </script>
  </body>
</html>
